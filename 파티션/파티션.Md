# ***파티션***  

## `파티션을 사용하는 이유`  
테이블은 논리적으로는 하나의 테이블이지만 물리적으로 여러개의 소규모 테이블로 분산하여 관리할 수 있게 해준다.  

## `어떨때?`  
하나의 테이블이 너무 커서 인덱스의 크기가 물리적인 메모리보다 훨씬 크거나 데이터 특성상 주기적인 삭제 작업이 필요한 경우 등에 사용.  
데이터와 인덱스를 조각화해서 물리적 메모리를 효율적으로 사용할 수 있게 만들어준다.  


## `이력 데이터의 효율적인 관리`  
로그 데이터의 경우 라이프 사이클이 상당히 짧다.  
로그 테이블을 파티션 테이블로 관리한다면 불필요한 데이터 삭제 작업은 단순히 파티션을 추가하거나 삭제하는 방식으로 간단하고 빠르게 해결 가능하다.  

```
X
ALTER TABLE DROP PARTITION...
2007년 파티션 

2008년 파티션 2009년 파티션...

+
ALTER TABLE ADD PARTITION...
2011년 파티션
```

## `파티션의 내부 처리`  

#### INSERT  
INSERT 쿼리가 실행되면 MYSQL 서버는 INSERT 되는 컬럼의 값 중에서 파티션의 키를 이용해 파티션 표현식을 평가하고,  
그 결과를 이용해 레코드가 저장될 적절한 파티션을 결정한다.  

#### UPDATE  
UPDATE 쿼리를 실행하려면 변경 대상 레코드가 어느 파티션에 저장돼 있는지 찾아야 한다.  
- 파티션 키 이외의 컬럼만 변경될 때는 파티션이 적용되지 않은 일반 테이블과 마찬가지로 컬럼 값만 변경한다.  
- 파티션 키 컬럼이 변경될 때는 기존의 레코드가 저장된 파티션에서 해당 레코드를 삭제한다.  그리고 변경되는 파티션 키 컬럼의 표현식을 평가하고, 그 결과를 이용해 레코드를 이동시킬 새로운 파티션을 결정해서 레코드를 새로 저장한다.  

